# ‚úÖ –§–∏–Ω–∞–ª—å–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞

## üéØ –ü—Ä–æ–±–ª–µ–º–∞:

**–ë—ã–ª–æ:**
```
‚ùå –§–æ—Ç–æ –æ–±—Ä–µ–∑–∞–µ—Ç—Å—è –∑–∞ –∫—Ä—É–≥–æ–º
‚ùå –¶–µ–Ω—Ç—Ä –∫—Ä—É–≥–∞ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Ñ–æ—Ç–æ (destination-out —É–¥–∞–ª—è–ª –≤—Å—ë)
‚ùå –í–∏–¥–Ω–æ —Ç–æ–ª—å–∫–æ –∫—Ä–∞—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
```

**–ü—Ä–∏—á–∏–Ω–∞:**
```javascript
ctx.globalCompositeOperation = 'destination-out';
// ‚Üê –£–¥–∞–ª—è–µ—Ç –í–°–Å (–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –∏ –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ)
```

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ:

**–ù–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º:**

```javascript
// 1. –†–∏—Å—É–µ–º –í–°–Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
ctx.drawImage(img, ...);

// 2. –°–æ–∑–¥–∞—ë–º —Å–æ—Å—Ç–∞–≤–Ω–æ–π –ø—É—Ç—å (compound path)
ctx.beginPath();
ctx.rect(0, 0, size, size);      // –í–µ—Å—å canvas
ctx.arc(x, y, r, 0, œÄ*2, true);  // –ö—Ä—É–≥ (–æ–±—Ä–∞—Ç–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)

// 3. –ó–∞–ø–æ–ª–Ω—è–µ–º –ø–æ –ø—Ä–∞–≤–∏–ª—É evenodd
ctx.fill('evenodd');
// ‚Üê –ó–∞–ø–æ–ª–Ω—è–µ—Ç –í–°–Å –ö–†–û–ú–ï –∫—Ä—É–≥–∞
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ –í–°–Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–∏–¥–Ω–æ
‚úÖ –í–Ω—É—Ç—Ä–∏ –∫—Ä—É–≥–∞ - —è—Ä–∫–æ–µ (–∏—Å—Ö–æ–¥–Ω—ã–µ —Ü–≤–µ—Ç–∞)
‚úÖ –ó–∞ –∫—Ä—É–≥–æ–º - –∑–∞—Ç–µ–º–Ω—ë–Ω–Ω–æ–µ
‚úÖ –¶–µ–Ω—Ç—Ä –∫—Ä—É–≥–∞ –ù–ï –∑–∞–∫—Ä—ã—Ç
```

---

## üé® –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç `evenodd` (fill rule):

### –ü—Ä–∞–≤–∏–ª–æ —á—ë—Ç–Ω–æ—Å—Ç–∏:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚Üê –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ (–ø—É—Ç—å 1)
‚îÇ ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚îÇ
‚îÇ ‚ñà‚ñà‚ñà  ‚≠ï –ö—Ä—É–≥  ‚ñà‚ñà‚ñà  ‚îÇ  ‚Üê –ö—Ä—É–≥ (–ø—É—Ç—å 2, –æ–±—Ä–∞—Ç–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)
‚îÇ ‚ñà‚ñà‚ñà   (–≤—ã—Ä–µ–∑)  ‚ñà‚ñà‚ñà  ‚îÇ
‚îÇ ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

fill('evenodd'):
- –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ = –∑–∞–ø–æ–ª–Ω–∏—Ç—å
- –ö—Ä—É–≥ (–æ–±—Ä–∞—Ç–Ω—ã–π) = –ù–ï –∑–∞–ø–æ–ª–Ω—è—Ç—å
- –†–µ–∑—É–ª—å—Ç–∞—Ç = –≤—Å—ë –∫—Ä–æ–º–µ –∫—Ä—É–≥–∞
```

### –û–±—ã—á–Ω—ã–π vs evenodd:

```javascript
// –û–±—ã—á–Ω—ã–π fill:
ctx.rect(0, 0, 400, 400);
ctx.arc(200, 200, 100, 0, Math.PI * 2);
ctx.fill(); // ‚Üê –ó–∞–ø–æ–ª–Ω—è–µ—Ç –í–°–Å (–∏ –∫—Ä—É–≥ —Ç–æ–∂–µ)

// Evenodd fill:
ctx.rect(0, 0, 400, 400);
ctx.arc(200, 200, 100, 0, Math.PI * 2, true); // ‚Üê true = –æ–±—Ä–∞—Ç–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
ctx.fill('evenodd'); // ‚Üê –ó–∞–ø–æ–ª–Ω—è–µ—Ç –≤—Å—ë –ö–†–û–ú–ï –∫—Ä—É–≥–∞
```

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤:

| –ú–µ—Ç–æ–¥ | –ü—Ä–æ–±–ª–µ–º–∞ | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|-------|----------|-----------|
| `clip()` | –û–±—Ä–µ–∑–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ | –§–æ—Ç–æ –Ω–µ –≤–∏–¥–Ω–æ –∑–∞ –∫—Ä—É–≥–æ–º ‚ùå |
| `destination-out` | –£–¥–∞–ª—è–µ—Ç –≤—Å—ë | –¶–µ–Ω—Ç—Ä –∫—Ä—É–≥–∞ –ø—É—Å—Ç–æ–π ‚ùå |
| `evenodd fill` | - | –†–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ ‚úÖ |

---

## üöÄ –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:

### src/components/AvatarUploader.tsx

**–§—É–Ω–∫—Ü–∏—è `drawPreview`:**

```typescript
// –£–î–ê–õ–ï–ù–û:
ctx.globalCompositeOperation = 'destination-out';
ctx.arc(...);
ctx.fill();

// –î–û–ë–ê–í–õ–ï–ù–û:
ctx.beginPath();
ctx.rect(0, 0, PREVIEW_SIZE, PREVIEW_SIZE);
ctx.arc(centerX, centerY, radius, 0, Math.PI * 2, true); // ‚Üê true!
ctx.fill('evenodd'); // ‚Üê evenodd!
```

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**
- ‚úÖ `true` –≤ `arc()` = –æ–±—Ä–∞—Ç–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (counterclockwise)
- ‚úÖ `fill('evenodd')` = –ø—Ä–∞–≤–∏–ª–æ —á—ë—Ç–Ω–æ—Å—Ç–∏
- ‚úÖ –ë–µ–∑ `globalCompositeOperation` = –Ω–µ —Ç—Ä–æ–≥–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ

---

## üéØ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

### –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ—Ñ–∏–ª—å –∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ

**–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚îÇ ‚Üê –í–°–Å —Ñ–æ—Ç–æ
‚îÇ ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà              ‚ñà‚ñà‚ñà    ‚îÇ   –≤–∏–¥–Ω–æ!
‚îÇ ‚ñà‚ñà‚ñà‚ñà   ‚≠ï –Ø–†–ö–ò–ô    ‚ñà‚ñà‚ñà‚ñà    ‚îÇ
‚îÇ ‚ñà‚ñà‚ñà‚ñà     –ö–†–£–ì      ‚ñà‚ñà‚ñà‚ñà    ‚îÇ
‚îÇ ‚ñà‚ñà‚ñà‚ñà              ‚ñà‚ñà‚ñà‚ñà‚ñà    ‚îÇ
‚îÇ ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚Üë                    ‚Üë
  –Ø—Ä–∫–∏–π –∫—Ä—É–≥      –ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ
  (–∞–≤–∞—Ç–∞—Ä)        (—Ñ–æ–Ω)
```

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
- ‚úÖ –í—Å—ë –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–∏–¥–Ω–æ
- ‚úÖ –¶–µ–Ω—Ç—Ä –∫—Ä—É–≥–∞ –ù–ï –∑–∞–∫—Ä—ã—Ç (–≤–∏–¥–Ω–æ —Ñ–æ—Ç–æ)
- ‚úÖ –í–Ω—É—Ç—Ä–∏ –∫—Ä—É–≥–∞ —è—Ä–∫–æ–µ
- ‚úÖ –ó–∞ –∫—Ä—É–≥–æ–º –∑–∞—Ç–µ–º–Ω—ë–Ω–Ω–æ–µ
- ‚úÖ –ú–æ–∂–Ω–æ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞—Ç—å
- ‚úÖ –ó—É–º —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ü–æ–≤–æ—Ä–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## üîç –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:

### Canvas Fill Rules:

**nonzero (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é):**
```javascript
ctx.fill(); // –∏–ª–∏ ctx.fill('nonzero');
// –ó–∞–ø–æ–ª–Ω—è–µ—Ç –≤—Å–µ –æ–±–ª–∞—Å—Ç–∏
```

**evenodd:**
```javascript
ctx.fill('evenodd');
// –ó–∞–ø–æ–ª–Ω—è–µ—Ç –ø–æ –ø—Ä–∞–≤–∏–ª—É —á—ë—Ç–Ω–æ—Å—Ç–∏:
// - –ß—ë—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π = –Ω–µ –∑–∞–ø–æ–ª–Ω—è—Ç—å
// - –ù–µ—á—ë—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ = –∑–∞–ø–æ–ª–Ω—è—Ç—å
```

### –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—É—Ç–∏:

**–û–±—ã—á–Ω–æ–µ (–ø–æ —á–∞—Å–æ–≤–æ–π):**
```javascript
ctx.arc(x, y, r, 0, Math.PI * 2, false);
// –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ
ctx.arc(x, y, r, 0, Math.PI * 2);
```

**–û–±—Ä–∞—Ç–Ω–æ–µ (–ø—Ä–æ—Ç–∏–≤ —á–∞—Å–æ–≤–æ–π):**
```javascript
ctx.arc(x, y, r, 0, Math.PI * 2, true);
//                                  ‚Üë
//                              –í–∞–∂–Ω–æ!
```

---

## ‚úÖ –ò—Ç–æ–≥–æ:

| –ß—Ç–æ | –ë—ã–ª–æ | –°—Ç–∞–ª–æ |
|-----|------|-------|
| –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ü–µ–ª–∏–∫–æ–º | –û–±—Ä–µ–∑–∞–Ω–æ ‚ùå | –í–∏–¥–Ω–æ ‚úÖ |
| –¶–µ–Ω—Ç—Ä –∫—Ä—É–≥–∞ | –ó–∞–∫—Ä—ã—Ç ‚ùå | –Ø—Ä–∫–∏–π ‚úÖ |
| –ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ | –í–µ–∑–¥–µ/–Ω–∏–≥–¥–µ ‚ùå | –¢–æ–ª—å–∫–æ –≤–æ–∫—Ä—É–≥ –∫—Ä—É–≥–∞ ‚úÖ |
| –ú–µ—Ç–æ–¥ | destination-out ‚ùå | evenodd fill ‚úÖ |

---

## üéâ –ì–æ—Ç–æ–≤–æ!

**–û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ:**

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ—Ñ–∏–ª—å
2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ
3. –£–≤–∏–¥–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä:
   - –í—Å—ë —Ñ–æ—Ç–æ –≤–∏–¥–Ω–æ
   - –ö—Ä—É–≥ —è—Ä–∫–∏–π
   - –§–æ–Ω –∑–∞—Ç–µ–º–Ω—ë–Ω–Ω—ã–π
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ

**–¢–µ–ø–µ—Ä—å –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ!** ‚úÖ

---

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:**
- `src/components/AvatarUploader.tsx` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω `drawPreview()`

**–í—Ä–µ–º—è:** –£–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ, –ø—Ä–æ—Å—Ç–æ –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É!

